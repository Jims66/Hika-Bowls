function submitForm(event) {
    event.preventDefault(); // Prevent default form submission

    let form = document.getElementById("orderForm");
    let rows = [];

    let sizes = document.querySelectorAll('[name="size[]"]');
    let qtys = document.querySelectorAll('[name="qty[]"]');
    let names = document.querySelectorAll('[name="name[]"]');

    for (let i = 0; i < sizes.length; i++) {
        rows.push({
            size: sizes[i].value,
            qty: qtys[i].value,
            name: names[i].value
        });
    }

    console.log("Collected Rows:", rows); // Debugging Log

    let formData = {
        orderName: document.getElementById("orderName").value,
        orderEmail: document.getElementById("orderEmail").value,
        rows: rows,
        comments: document.getElementById("comments").value
    };

    console.log("Submitting Data:", formData); // Debugging Log

    fetch("https://script.google.com/macros/s/AKfycbw6FFPLokhQKwkw1SM8PNTxFdMob7-XsPqgm_EoH95_Mhht3vIkQ-OudUz0hbpRS_qL/exec", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(formData)
    })
    .then(response => response.text())
    .then(data => {
        console.log("Response:", data); // Debugging Log
        alert("Order submitted successfully!");
        form.reset();
    })
    .catch(error => console.error("Error:", error));
}
