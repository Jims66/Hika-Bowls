function doPost(e) {
    if (!e || !e.postData) {
        return ContentService.createTextOutput("No data received").setMimeType(ContentService.MimeType.TEXT);
    }

    var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("Hoodie Orders");

    // Parse the incoming JSON data
    var data = JSON.parse(e.postData.contents);

    var name = data.orderName || "";
    var email = data.orderEmail || "";
    var comments = data.comments || "";
    var rows = data.rows || [];

    // Prepare the data for Google Sheets
    var sheetRows = [];
    for (var i = 0; i < rows.length; i++) {
        sheetRows.push([
            name,                 // User's name (same for all rows)
            email,                // User's email (same for all rows)
            rows[i].size || "",   // Hoodie size
            rows[i].qty || "",    // Quantity
            rows[i].name || "",   // Name on hoodie
            comments || "",       // Comments
            new Date()            // Timestamp
        ]);
    }

    // Append all rows at once to Google Sheets
    if (sheetRows.length > 0) {
        sheet.getRange(sheet.getLastRow() + 1, 1, sheetRows.length, sheetRows[0].length).setValues(sheetRows);
    }

    return ContentService.createTextOutput("Success").setMimeType(ContentService.MimeType.TEXT);
}
