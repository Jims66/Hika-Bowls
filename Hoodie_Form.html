function submitForm(event) {
    event.preventDefault(); // Prevent default form submission

    let form = document.getElementById("orderForm");
    let rows = [];

    let sizes = document.querySelectorAll('[name="size[]"]');
    let qtys = document.querySelectorAll('[name="qty[]"]');
    let names = document.querySelectorAll('[name="name[]"]');

    if (sizes.length === 0) {
        alert("Please add at least one order.");
        return;
    }

    for (let i = 0; i < sizes.length; i++) {
        rows.push({
            size: sizes[i].value,
            qty: qtys[i].value,
            name: names[i].value
        });
    }

    let formData = {
        orderName: document.getElementById("orderName").value,
        orderEmail: document.getElementById("orderEmail").value,
        rows: rows,
        comments: document.getElementById("comments").value
    };

    console.log("✅ Submitting Data:", formData);

    fetch("YOUR_NEW_GOOGLE_APPS_SCRIPT_URL_HERE", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(formData)
    })
    .then(response => {
        if (!response.ok) {
            throw new Error(`HTTP error! Status: ${response.status}`);
        }
        return response.json();
    })
    .then(data => {
        console.log("✅ Response from Server:", data);
        if (data.status === "Success") {
            alert("Order submitted successfully!");
            form.reset();
        } else {
            alert("Error: " + data.message);
        }
    })
    .catch(error => {
        console.error("❌ Fetch Error:", error);
        alert("There was an issue submitting your order. Check console for details.");
    });
}
